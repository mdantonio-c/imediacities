<div
  ng-if="datactrl.loading"
  ng-include="main.templateDir + 'loader.html'">
</div>
<div class='row' ng-if='!profile.isAdmin'>
  <div class='col-xs-12 text-center'>
    <div class='panel panel-danger'>
      <div class='panel-body palette-Red-100 bg'>
        <i class='material-icons medium palette-Red-500 text'>warning</i>
        <br>
        <h3>
        Unauthorized
        </h3>
      </div>
    </div>
  </div>
</div>
<div ng-controller='ArchiveController as ctrl' ng-if='profile.isAdmin'>
  <div ng-controller='ListsController as listctrl'>
    <uib-accordion close-others="oneAtATime">
    <div ng-repeat="group in ctrl.groups"
      uib-accordion-group class="panel-default"
      is-open="false">
      <uib-accordion-heading>
      Stage files uploaded by <b>{{group.fullname}}</b> (<i>{{group.id}}</i>)
      </uib-accordion-heading>
      <div ng-show="!ctrl.files[group.id]">
        No file uploaded
      </div>
      <div class="table-responsive" ng-show="ctrl.files[group.id]">
        <table
          class='table table-hover table-condensed table-borderless'
          ts-filter-fields="name,type"
          ts-wrapper>
          <thead>
            <tr class='active'>
              <th ts-criteria="name">Filename</th>
              <th ts-criteria="type">Type</th>
              <th ts-criteria="size | parseInt">Size</th>
              <th ts-criteria="modification | parseInt">Uploaded</th>
              <!-- <th ts-criteria="modification | parseInt">Modified</th> -->
              <th ts-criteria="status">Status</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="data in ctrl.files[group.id]" ts-repeat>
              <!--
              <td ng-click='listctrl.selectElement(data)'>
                <i ng-if="!data.isSelected" class='material-icons'>check_box_outline_blank</i>
                <i ng-if="data.isSelected" class='material-icons'>check_box</i>
              </td>
              -->
              <td><b>{{data.name}}</b></td>
              <td>
                {{data.type}}
              </td>
              <td>{{data.size | bytes}}</td>
              <td>
                <span uib-tooltip='{{data.modification | unix_date}}'>
                  {{data.modification | moment_unix: 'fromNow'}}
                </span>
              </td>
              <!--       <td>
                <span uib-tooltip='{{data.modification | unix_date}}'>
                  {{data.modification | moment_unix: 'fromNow'}}
                </span>
              </td> -->
              <td ng-if='data.status_message'>
                <span uib-tooltip='{{data.status_message}}'
                  class="label label-info"
                  ng-class="{
                  'label-success': data.status == 'COMPLETED',
                  'label-danger': data.status == 'ERROR',
                  'label-info': data.status == 'IMPORTING',
                  }">
                  {{data.status}}
                </span>
              </td>
              <td ng-if='!data.status_message'>
                {{data.status}}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    </uib-accordion>
  </div>
</div>
