version: '3'

services:
  frontend:
    image: rapydo/frontend
    command: ./boot
    hostname: frontend
    working_dir: /data/frontend
    volumes:
      # Main dir. It has to be the root directory, to make links work
      - ..:/data
      # Configuration files
      - ../specs:/data/frontend/config/specs
      # SHARED WITH PROXY:
      - ../frontend/js/angular:/data/frontend/felask/static/app/commons
      - ../frontend/css:/data/frontend/felask/static/css/base
      - ../frontend/fonts:/data/frontend/felask/static/fonts
      - ../frontend/templates:/data/frontend/felask/static/app/templates/common
      # js/css libraries installed via bower
      - ../libs/bower_components:/data/frontend/felask/static/bower
      # js/css custom
      - ../js:/data/frontend/felask/static/app/custom
      - ../templates:/data/frontend/felask/static/app/templates/custom
      - ../css:/data/frontend/felask/static/css/custom

  ###############################
  # Make automatic to install libraries
  bower:
      image: pdonorio/jsdev
      working_dir: /data/libs
      volumes:
        - ..:/data

  ###############################
  proxy:
    volumes:
      # SHARED WITH FRONTEND:
      - ../frontend/js/angular:/data/frontend/felask/static/app/commons
      - ../frontend/css:/data/frontend/felask/static/css/base
      - ../frontend/fonts:/data/frontend/felask/static/fonts
      - ../frontend/templates:/data/frontend/felask/static/app/templates/common
      # js/css libraries installed via bower
      - ../libs/bower_components:/data/frontend/felask/static/bower
      # Custom css/js
      - ../js:/data/frontend/felask/static/app/custom
      - ../templates:/data/frontend/felask/static/app/templates/custom
      - ../css:/data/frontend/felask/static/css/custom

  ###############################
  # Make automatic to install libraries
  # karma:
  #     image: pdonorio/jsdev
  #     working_dir: /data
  #     volumes:
  #         - ../libs/bower_components:/data/bower_components
  #         - ../jscode:/data
